---
title: 
   LeetCodeå•è°ƒæ ˆ
tags: 
  [LeetCode]
categories:
	[ç®—æ³•]
cover: http://static.imlgw.top/blog/20191002/0SOOjUptvAlJ.jpg?imageslim
---

> ä»[æ ˆ&é˜Ÿåˆ—ä¸“é¢˜](http://imlgw.top/2019/10/01/leetcode-zhan-dui-lie/)ä¸­æŠ½å–å‡ºæ¥
## [496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I](https://leetcode-cn.com/problems/next-greater-element-i/)

ç»™å®šä¸¤ä¸ª**æ²¡æœ‰é‡å¤å…ƒç´ **çš„æ•°ç»„ nums1 å’Œ nums2 ï¼Œå…¶ä¸­nums1 æ˜¯ nums2 çš„å­é›†ã€‚æ‰¾åˆ° nums1 ä¸­æ¯ä¸ªå…ƒç´ åœ¨ nums2 ä¸­çš„ä¸‹ä¸€ä¸ªæ¯”å…¶å¤§çš„å€¼ã€‚

nums1 ä¸­æ•°å­— x çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ æ˜¯æŒ‡ x åœ¨ nums2 ä¸­å¯¹åº”ä½ç½®çš„å³è¾¹çš„ç¬¬ä¸€ä¸ªæ¯” x å¤§çš„å…ƒç´ ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå¯¹åº”ä½ç½®è¾“å‡º-1ã€‚

**ç¤ºä¾‹ 1:**

```java
è¾“å…¥: nums1 = [4,1,2], nums2 = [1,3,4,2].
è¾“å‡º: [-1,3,-1]
è§£é‡Š:
    å¯¹äºnum1ä¸­çš„æ•°å­—4ï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚
    å¯¹äºnum1ä¸­çš„æ•°å­—1ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ•°å­—1å³è¾¹çš„ä¸‹ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯ 3ã€‚
    å¯¹äºnum1ä¸­çš„æ•°å­—2ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚
```

**ç¤ºä¾‹ 2:**

```java
è¾“å…¥: nums1 = [2,4], nums2 = [1,2,3,4].
è¾“å‡º: [3,-1]
è§£é‡Š:
    å¯¹äºnum1ä¸­çš„æ•°å­—2ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯3ã€‚
    å¯¹äºnum1ä¸­çš„æ•°å­—4ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚
```

**æ³¨æ„:**

1. `nums1`å’Œ`nums2`ä¸­æ‰€æœ‰å…ƒç´ æ˜¯å”¯ä¸€çš„ã€‚
2. `nums1`å’Œ`nums2` çš„æ•°ç»„å¤§å°éƒ½ä¸è¶…è¿‡1000ã€‚

**è§£æ³•ä¸€**

å•è°ƒæ ˆï¼Œå¾ˆå°±ä¹‹å‰åœ¨é“¾è¡¨ä¸“é¢˜ä¸­åšè¿‡ä¸€æ¬¡ [é“¾è¡¨çš„ä¸‹ä¸€ä¸ªæ›´å¤§èŠ‚ç‚¹](http://imlgw.top/2019/02/27/leetcode-lian-biao/#1019-%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E8%8A%82%E7%82%B9) ä½†æ˜¯æ²¡æƒ³èµ·æ¥ï¼Œå¯èƒ½å½“æ—¶ä¹Ÿæ²¡ç•™ä¸‹å½±å“

è¿™é¢˜å…¶å®è¿˜æ¯”åŸå§‹çš„é¢˜åŠ äº†ä¸€ç‚¹éš¾åº¦ï¼ŒåŸå§‹çš„é¢˜å°±æ˜¯ num1==nums2çš„æƒ…å†µï¼Œé‚£æ ·å°±ä¸éœ€è¦HashMapè®°å½•äº†

```java
public int[] nextGreaterElement(int[] nums1, int[] nums2) {
    HashMap<Integer,Integer> map=new HashMap<>();
    Stack<Integer> stack=new Stack<>();
    for (int i=0;i<nums2.length;i++) {
        while(!stack.isEmpty() && nums2[stack.peek()]<nums2[i]){
            map.put(nums2[stack.pop()],nums2[i]);
        }
        stack.add(i);
    }
    int[] res=new int[nums1.length];
    for (int i=0;i<nums1.length;i++) {
        res[i]=map.getOrDefault(nums1[i],-1);
    }
    return res;
}
```
## [503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II](https://leetcode-cn.com/problems/next-greater-element-ii/)

ç»™å®šä¸€ä¸ªå¾ªç¯æ•°ç»„ï¼ˆæœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¾“å‡ºæ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€‚æ•°å­— x çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´ æ˜¯æŒ‰æ•°ç»„éå†é¡ºåºï¼Œè¿™ä¸ªæ•°å­—ä¹‹åçš„ç¬¬ä¸€ä¸ªæ¯”å®ƒæ›´å¤§çš„æ•°ï¼Œè¿™æ„å‘³ç€ä½ åº”è¯¥å¾ªç¯åœ°æœç´¢å®ƒçš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º -1ã€‚

**ç¤ºä¾‹ 1:**

```java
è¾“å…¥: [1,2,1]
è¾“å‡º: [2,-1,2]
è§£é‡Š: ç¬¬ä¸€ä¸ª 1 çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°æ˜¯ 2ï¼›
æ•°å­— 2 æ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°ï¼› 
ç¬¬äºŒä¸ª 1 çš„ä¸‹ä¸€ä¸ªæœ€å¤§çš„æ•°éœ€è¦å¾ªç¯æœç´¢ï¼Œç»“æœä¹Ÿæ˜¯ 2ã€‚
```

**æ³¨æ„:** è¾“å…¥æ•°ç»„çš„é•¿åº¦ä¸ä¼šè¶…è¿‡ 10000ã€‚

**è§£æ³•ä¸€**

```java
public static int[] nextGreaterElements(int[] nums) {
    if (nums==null || nums.length<=0) {
        return new int[]{};
    }
    Stack<Integer> stack=new Stack<>();
    stack.push(0);
    int[] res=new int[nums.length];
    Arrays.fill(res,-1);
    int index=1;
    for (int i=1;i<nums.length*2;i++) {
        index=i>=nums.length?i%nums.length:i;
        while(!stack.isEmpty()&&nums[stack.peek()]<nums[index]) {
            res[stack.pop()]=nums[index];
        }
        stack.push(index);
    }
    return res;
}
```
å’Œä¸Šé¢ä¸€æ ·ï¼Œåªä¸è¿‡éœ€è¦å¾ªç¯éå†ä¸€éï¼Œæˆ‘æœ€å¼€å§‹çš„åšæ³•ç›¸å½“æ†¨æ†¨ï¼Œcopyäº†ä¸€ä¸ªä¸¤å€çš„æ•°ç»„ã€‚ã€‚ã€‚è¿˜éœ€è¦æ³¨æ„çš„å°±æ˜¯ `-1`çš„å¤„ç†

## [739. æ¯æ—¥æ¸©åº¦](https://leetcode-cn.com/problems/daily-temperatures/)

æ ¹æ®æ¯æ—¥ æ°”æ¸© åˆ—è¡¨ï¼Œè¯·é‡æ–°ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨ï¼Œå¯¹åº”ä½ç½®çš„è¾“å…¥æ˜¯ä½ éœ€è¦å†ç­‰å¾…å¤šä¹…æ¸©åº¦æ‰ä¼šå‡é«˜è¶…è¿‡è¯¥æ—¥çš„å¤©æ•°ã€‚å¦‚æœä¹‹åéƒ½ä¸ä¼šå‡é«˜ï¼Œè¯·åœ¨è¯¥ä½ç½®ç”¨ 0 æ¥ä»£æ›¿ã€‚

ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªåˆ—è¡¨ temperatures = [73, 74, 75, 71, 69, 72, 76, 73]ï¼Œä½ çš„è¾“å‡ºåº”è¯¥æ˜¯ [1, 1, 4, 2, 1, 1, 0, 0]ã€‚

æç¤ºï¼šæ°”æ¸© åˆ—è¡¨é•¿åº¦çš„èŒƒå›´æ˜¯ [1, 30000]ã€‚æ¯ä¸ªæ°”æ¸©çš„å€¼çš„å‡ä¸ºåæ°åº¦ï¼Œéƒ½æ˜¯åœ¨ [30, 100] èŒƒå›´å†…çš„æ•´æ•°ã€‚

**è§£æ³•ä¸€**

```java
public int[] dailyTemperatures(int[] T) {
    int[] res=new int[T.length];
    if(T==null || T.length<=0) return res;
    Stack<Integer> stack=new Stack<>();
    stack.push(0);
    for (int i=1;i<T.length;i++) {
        while(!stack.isEmpty()&&T[stack.peek()]<T[i]){
            int temp=stack.pop();
            res[temp]=i-temp;
        }
        stack.push(i);
    }
    return res;
}
```
å’Œä¸Šé¢ä¸¤é¢˜ä¸€æ ·ï¼Œå•è°ƒæ ˆçš„è§£æ³•ï¼Œä¸è¿‡è¿™é¢˜å¥½åƒå¯ä»¥ä¸ç”¨å•è°ƒæ ˆï¼Œå¯ä»¥ä»åå‘å‰é€’æ¨

## [901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦](https://leetcode-cn.com/problems/online-stock-span/)

ç¼–å†™ä¸€ä¸ª StockSpanner ç±»ï¼Œå®ƒæ”¶é›†æŸäº›è‚¡ç¥¨çš„æ¯æ—¥æŠ¥ä»·ï¼Œå¹¶è¿”å›è¯¥è‚¡ç¥¨å½“æ—¥ä»·æ ¼çš„è·¨åº¦ã€‚

ä»Šå¤©è‚¡ç¥¨ä»·æ ¼çš„è·¨åº¦è¢«å®šä¹‰ä¸ºè‚¡ç¥¨ä»·æ ¼å°äºæˆ–ç­‰äºä»Šå¤©ä»·æ ¼çš„æœ€å¤§è¿ç»­æ—¥æ•°ï¼ˆä»ä»Šå¤©å¼€å§‹å¾€å›æ•°ï¼ŒåŒ…æ‹¬ä»Šå¤©ï¼‰ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæœªæ¥7å¤©è‚¡ç¥¨çš„ä»·æ ¼æ˜¯ [100, 80, 60, 70, 60, 75, 85]ï¼Œé‚£ä¹ˆè‚¡ç¥¨è·¨åº¦å°†æ˜¯ [1, 1, 1, 2, 1, 4, 6]ã€‚

**ç¤ºä¾‹ï¼š**

```java
è¾“å…¥ï¼š["StockSpanner","next","next","next","next","next","next","next"], [[],[100],[80],[60],[70],[60],[75],[85]]
è¾“å‡ºï¼š[null,1,1,1,2,1,4,6]
è§£é‡Šï¼š
é¦–å…ˆï¼Œåˆå§‹åŒ– S = StockSpanner()ï¼Œç„¶åï¼š
S.next(100) è¢«è°ƒç”¨å¹¶è¿”å› 1ï¼Œ
S.next(80) è¢«è°ƒç”¨å¹¶è¿”å› 1ï¼Œ
S.next(60) è¢«è°ƒç”¨å¹¶è¿”å› 1ï¼Œ
S.next(70) è¢«è°ƒç”¨å¹¶è¿”å› 2ï¼Œ
S.next(60) è¢«è°ƒç”¨å¹¶è¿”å› 1ï¼Œ
S.next(75) è¢«è°ƒç”¨å¹¶è¿”å› 4ï¼Œ
S.next(85) è¢«è°ƒç”¨å¹¶è¿”å› 6ã€‚

æ³¨æ„ (ä¾‹å¦‚) S.next(75) è¿”å› 4ï¼Œå› ä¸ºæˆªè‡³ä»Šå¤©çš„æœ€å 4 ä¸ªä»·æ ¼
(åŒ…æ‹¬ä»Šå¤©çš„ä»·æ ¼ 75) å°äºæˆ–ç­‰äºä»Šå¤©çš„ä»·æ ¼ã€‚
```

**æç¤ºï¼š**

- è°ƒç”¨ StockSpanner.next(int price) æ—¶ï¼Œå°†æœ‰ 1 <= price <= 10^5
- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æœ€å¤šå¯ä»¥è°ƒç”¨  10000 æ¬¡ StockSpanner.next
- åœ¨æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæœ€å¤šè°ƒç”¨ 150000 æ¬¡ StockSpanner.next
- æ­¤é—®é¢˜çš„æ€»æ—¶é—´é™åˆ¶å‡å°‘äº† 50%

**è§£æ³•ä¸€**

æˆ‘èµ·äº†ï¼Œä¸€æªç§’äº†ï¼Œæœ‰ä»€ä¹ˆå¥½è¯´çš„

```java
class StockSpanner {

    Deque<int[]> stack=new ArrayDeque<>();

    public StockSpanner() {}
    
    public int next(int price) {
        int res=1;
        while(!stack.isEmpty() && price>=stack.peek()[0]){
            res+=stack.pop()[1];
        }
        stack.push(new int[]{price,res});
        return res;
    }
}
```

## [84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/)

ç»™å®š *n* ä¸ªéè´Ÿæ•´æ•°ï¼Œç”¨æ¥è¡¨ç¤ºæŸ±çŠ¶å›¾ä¸­å„ä¸ªæŸ±å­çš„é«˜åº¦ã€‚æ¯ä¸ªæŸ±å­å½¼æ­¤ç›¸é‚»ï¼Œä¸”å®½åº¦ä¸º 1 ã€‚

æ±‚åœ¨è¯¥æŸ±çŠ¶å›¾ä¸­ï¼Œèƒ½å¤Ÿå‹¾å‹’å‡ºæ¥çš„çŸ©å½¢çš„æœ€å¤§é¢ç§¯ã€‚

![leetCode](https://i.loli.net/2019/12/12/a7pVfNcYuIKFgwA.png)

ä»¥ä¸Šæ˜¯æŸ±çŠ¶å›¾çš„ç¤ºä¾‹ï¼Œå…¶ä¸­æ¯ä¸ªæŸ±å­çš„å®½åº¦ä¸º 1ï¼Œç»™å®šçš„é«˜åº¦ä¸º `[2,1,5,6,2,3]`ã€‚

![leetCode](https://i.loli.net/2019/12/12/FAvMk3zWf4RheDi.png)

å›¾ä¸­é˜´å½±éƒ¨åˆ†ä¸ºæ‰€èƒ½å‹¾å‹’å‡ºçš„æœ€å¤§çŸ©å½¢é¢ç§¯ï¼Œå…¶é¢ç§¯ä¸º `10` ä¸ªå•ä½ã€‚

**ç¤ºä¾‹:**

```java
è¾“å…¥: [2,1,5,6,2,3]
è¾“å‡º: 10
```

**è§£æ³•ä¸€**

å’Œä¸Šé¢å‡ é“é¢˜ä¸€æ ·ï¼Œå•è°ƒæ ˆçš„è§£æ³•ï¼Œè¿™é‡Œæ˜¯å•è°ƒé€’å¢æ ˆï¼Œ20msï¼Œ87%

```java
public int largestRectangleArea(int[] heights) {
    if (heights==null || heights.length<=0) {
        return 0;
    }
    Stack<Integer> stack=new Stack<>();
    int maxArea= Integer.MIN_VALUE;
    for (int i=0;i<heights.length;i++) {
        while(!stack.isEmpty() && heights[i]<=heights[stack.peek()]){
            //å½“å‰çš„æŸ±å­å°äºæ ˆé¡¶,è¯´æ˜å½“å‰æ ˆé¡¶æœ€å¤šå‘å³æ‰©å±•åˆ° i-1
            int cur=stack.pop();
            //ä¸ºç©ºè¯´æ˜å‘å·¦æ— æ³•æ‰©å±•,æ ‡ä¸º-1ä¸å½±å“ç»“æœï¼ˆå¯ä»¥æå‰å°†-1å‹æ ˆï¼‰
            int left=stack.isEmpty()?-1:stack.peek();
            //è¿™é‡Œå…¶å®æ˜¯ (i-1)-(left+1)+1
            maxArea=Math.max(maxArea,(i-left-1)*heights[cur]);
        }
        stack.push(i);
    }
    //å¤„ç†æ ˆä¸­å‰©ä¸‹çš„å…ƒç´ ,å³è¾¹æ˜¯è¾¹ç•Œï¼Œå‰©ä½™æ ˆä¸­æ‰€æœ‰çš„å…ƒç´ å®é™…ä¸Šéƒ½å¯ä»¥æ‰©å±•åˆ° heights.length-1
    //æ‰€ä»¥ä¸ºäº†è®©æ‰€æœ‰çš„å…ƒç´ éƒ½èƒ½å‡ºæ ˆ,æˆ‘ä»¬å¯ä»¥å†æ•°ç»„çš„åé¢æƒ³è±¡æ·»åŠ ä¸€ä¸ª0(ä¹Ÿå¯ä»¥ç›´æ¥åœ¨åŸæ•°ç»„ä¸­æ·»åŠ ä¸€ä¸ª0)
    while(!stack.isEmpty()){ 
        int cur=stack.pop();
        int left=stack.isEmpty()?-1:stack.peek();
        //è¿™ä¸€æ­¥å¾ˆç§€,åœ¨æ•°ç»„åé¢å†æƒ³è±¡ä¸€ä¸ª0å‡ºæ¥
        //è®©æ ˆä¸­å…ƒç´ å‘å³æ‰©å¼ (heights.length-1)-(left+1)+1
        maxArea=Math.max(maxArea,(heights.length-left-1)*heights[cur]);
    }
    return maxArea;
}
```
å…¶å®å°±æ˜¯åˆ©ç”¨å•è°ƒæ ˆéå†æ¯ä¸€ä¸ªæŸ±å­ï¼Œ**æ‰¾åˆ°æ¯ä¸€ä¸ªæŸ±å­å·¦è¾¹å’Œå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„å…ƒç´ ï¼Œæ¯”å¦‚å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å½“å‰æŸ±å­å°çš„æ˜¯iï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶i+1è‚¯å®šæ˜¯å¤§äºç­‰äºå½“å‰æŸ±å­çš„ï¼Œå¹¶ä¸”i+1æ˜¯å·¦è¾¹è¿ç»­å¤§äºå½“å‰æŸ±å­çš„æœ€åä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯å½“å‰æŸ±å­èƒ½æƒ³å·¦æ‰©å±•çš„è¾¹ç•Œä½ç½®ï¼Œå³è¾¹åŒç†ï¼Œæ—¢ç„¶æ˜¯è¦æ±‚å·¦å³æ¯”å½“å‰æŸ±å­å°çš„ç¬¬ä¸€ä¸ªï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾å°±è¦ç”¨å•è°ƒé€’å¢æ ˆ**ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥æ ¹æ®è¿™ä¸¤ä¸ªæ•°æ®è®¡ç®—å®Œå…¨åŒ…å«å½“å‰æŸ±å­çš„æœ€å¤§çš„çŸ©å½¢çš„é¢ç§¯ã€‚

ä¾‹å¦‚: `3 4 5 4 3 6` 

é¦–å…ˆ`3 4 5`éƒ½é¡ºåˆ©çš„å­˜å…¥æ ˆä¸­ï¼Œæ­¤æ—¶æ ˆä¸­å…ƒç´ ä¸º`ã€0ï¼Œ1ï¼Œ2ã€‘` ï¼Œå½“æƒ³å­˜å…¥ä¸‹ä¸€ä¸ªå…ƒç´ `i=3,h[i]=4`çš„æ—¶å€™ï¼Œå‘ç°4æ¯”å½“å‰æ ˆé¡¶å°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è®¡ç®—**å®Œå…¨åŒ…å«æ ˆä¸­æ¯ä¸ªæŸ±å­**çš„æœ€å¤§çŸ©å½¢çš„é¢ç§¯

1. ç”±äºå½“å‰**`i`** ä½ç½®çš„å…ƒç´ æ˜¯æ¯”æ ˆé¡¶å°ï¼Œé‚£ä¹ˆå°±è¯´æ˜ **`i-1`** ä½ç½®çš„å…ƒç´ ä¸€å®šæ¯”å½“å‰æ ˆé¡¶å…ƒç´ å¤§ï¼ä¹Ÿå°±æ˜¯å‘å³è¾¹æœ€å¤šæ‰©å±•åˆ°**`i-1`**ä½ç½®

2. ç”±äºå•è°ƒæ ˆçš„ç»“æ„ï¼Œå½“å‰æ ˆé¡¶çš„ä¸‹ä¸€ä¸ªæ ˆä¸­å…ƒç´ **`left`**ï¼Œå…¶å®å°±æ˜¯å½“å‰æ ˆé¡¶çš„å·¦è¾¹æœ€è¿‘çš„æ¯”å®ƒå°çš„å…ƒç´ ï¼Œæ‰€ä»¥**`left+1`**ä½ç½®çš„å…ƒç´ ä¸€å®šæ˜¯æ¯”å½“å‰æ ˆé¡¶å…ƒç´ å¤§(ä¹Ÿæœ‰å¯èƒ½ç›¸ç­‰)ï¼ï¼Œæ‰€ä»¥å‘å·¦è¾¹æœ€å¤šæ‰©å±•åˆ° **`left+1`** ä½ç½®

3. ä¸Šé¢å…¶å®è¿˜åˆ†ææ¼äº†ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯æ ˆé¡¶å’Œ **`i`** ä½ç½®å…ƒç´ ç›¸ç­‰çš„æƒ…å†µï¼Œç¬¬ä¸€ç‚¹ä¸­æåˆ°çš„å…¶å®æ˜¯ **`i`** ä½ç½®å…ƒç´ å°äºæ ˆé¡¶çš„æƒ…å†µï¼Œå¦‚æœç›¸ç­‰ï¼Œé‚£ä¹ˆå‘å³èƒ½æ‰©å±•åˆ°çš„ä½ç½®è¿˜ä¼šæ˜¯**`i-1`**ä¹ˆï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œè‡³å°‘åº”è¯¥æ˜¯**`i`**ç”šè‡³æ›´å¤§ï¼Œé‚£æˆ‘ä»¬è¿™é‡Œè®¡ç®—çš„å³è¾¹ç•Œä¸å°±æ˜¯é”™è¯¯çš„ï¼Ÿé‚£æˆ‘ä»¬å°† **`=`** å»æ‰å¯ä»¥ä¹ˆï¼Ÿå»æ‰ä¹‹åå•è°ƒæ ˆå°±ä¸å†æ˜¯ä¸¥æ ¼å•è°ƒäº†ï¼Œè¿™æ ·çš„åˆ°çš„å³è¾¹ç•Œç¡®å®å‡†ç¡®äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çš„å·¦è¾¹ç•Œç”±äºæ ˆä¸­å­˜åœ¨ç›¸ç­‰çš„å…ƒç´ ï¼Œå°±å˜çš„ä¸å†å‡†ç¡®äº†ï¼

4. é‚£æˆ‘ä»¬å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µå‘¢ï¼Ÿå…¶å®æ ¹æœ¬å°±ä¸ç”¨å¤„ç†ï¼Œæ—¢ç„¶æ ˆé¡¶èƒ½**å‘å³**æ‰©å±•åˆ° **`i-1`** é‚£ä¹ˆåè¿‡æ¥ï¼Œ**`i-1`** ä¸€æ ·å¯ä»¥**å‘å·¦**æ‰©å±•åˆ°**æ ˆé¡¶** ä½ç½®ï¼Œè¿›è€Œè¿˜å¯ä»¥æ‰©å±•åˆ°**`left+1`**ä½ç½®ï¼Œè€Œå‘å·¦æ‰©å±•çš„**`left+1`**æ˜¯å‡†ç¡®çš„ï¼Œä¸ä¼šæœ‰è¯¯å·®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç­‰å¾… **`i-1`**ä½ç½®çš„å…ƒç´ å¼¹å‡ºï¼Œç„¶åå°±å¯ä»¥é‡æ–°è®¡ç®—å¾—åˆ°æœ€å¤§å€¼ï¼Œè¿™ä¸ªæœ€å¤§å€¼è‚¯å®šæ˜¯åŒ…å«ä¹‹å‰çš„å“ªä¸ªæœ€å¤§å½“ç„¶è¿™é‡Œå…¶å®é‚£ä¸ª **`heights[i]<=heights[stack.peek()]`** ä¸­çš„ç­‰å·ä¹Ÿå¯ä»¥å»æ‰ï¼Œè¿™æ ·æ ˆå°±ä¸æ˜¯ä¸¥æ ¼å•è°ƒçš„äº†ï¼Œ**`left+1`**ä¹Ÿä¸å†å‡†ç¡®ï¼Œä½†æ˜¯æ­¤æ—¶ **`i-1`** å°±å‡†ç¡®äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç­‰å¾…**`left+1`** å¼¹æ ˆä¹‹åå†é‡æ–°è®¡ç®—ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ç›¸ç­‰çš„æƒ…å†µæ˜¯ä¸ç”¨åšé¢å¤–çš„å¤„ç†

   ![mark](http://static.imlgw.top/blog/20200129/gJPOkfEPDxwg.png?imageslim)

   å¯ä»¥çœ‹åˆ°æŒ‰ç…§ä»£ç ä¸­çš„é€»è¾‘åœ¨è®¡ç®—å®Œå…¨åŒ…å«å½“å‰ç»¿è‰²çš„æ ˆé¡¶å…ƒç´ çš„æœ€å¤§çŸ©å½¢çš„æ—¶å€™å…¶å®åªè®¡ç®—åˆ°ä¸€éƒ¨åˆ†ï¼Œå½“è®¡ç®—åˆ°åé¢çš„ç›¸ç­‰çš„æŸ±å­çš„æ—¶å€™ä¼šå®Œå…¨åŒ…å«ä¹‹å‰çš„æŸ±å­çš„å€¼ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰é—®é¢˜

â€‹       

ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œä»£ç å°±å¥½å†™å¤šäº†ï¼Œä¸è¿‡è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåœ°æ–¹å€¼å¾—æ³¨æ„ï¼Œå°±æ˜¯å¤„ç†æ ˆä¸­å‰©ä½™çš„å…ƒç´ ï¼Œå…¶å®æ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯åœ¨æ•°ç»„çš„æœ«å°¾åŠ ä¸€ä¸ª0ï¼Œè¿™æ ·ç¡®ä¿æ ˆä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½å¯ä»¥å‡ºæ ˆï¼Œä¸ç”¨é¢å¤–çš„å¤„ç†ï¼Œjavaä¸­æ²¡æ³•ç›´æ¥å‘æ•°ç»„ä¸­pushå…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æƒ³è±¡æœ«å°¾æœ‰ä¸€ä¸ª0ï¼Œé‚£ä¹ˆæ‰€æœ‰å…ƒç´ å‘å·¦èƒ½æ‰©å±•åˆ°çš„æœ€è¿œä½ç½®å°±æ˜¯ `heights.length-1`

**è§£æ³•äºŒ**

åˆ†æ²»ï¼Œ480msï¼Œ27%

```java
//åˆ†æ²» 480ms
public int largestRectangleArea(int[] heights) {
    if (heights==null || heights.length<=0) {
        return 0;
    }
    largestRectangleArea(heights,0,heights.length-1);
    return maxArea;
}

private int maxArea=Integer.MIN_VALUE;

public void largestRectangleArea(int[] heights,int left,int right) {
    if (left>right) {
        return;
    }
    int minIndex=left;
    for (int i=left;i<=right;i++) {
        minIndex=heights[i]<heights[minIndex]?i:minIndex;
    }
    maxArea=Math.max(heights[minIndex]*(right-left+1),maxArea);
    largestRectangleArea(heights,left,minIndex-1);
    largestRectangleArea(heights,minIndex+1,right);
}
```
å°†æ•°ç»„åŒºé—´ä»¥`minIndex`ä¸ºåˆ†ç•Œçº¿ï¼Œåˆ†åˆ«æ±‚å·¦è¾¹å’Œå³è¾¹çš„æœ€å¤§é¢ç§¯ï¼Œæ—¶é—´å¤æ‚åº¦`O(NlogN)`

**è§£æ³•ä¸‰**

ä¼˜åŒ–çš„åˆ†æ²» 1msï¼Œ100%ï¼Œæ²¡æƒ³åˆ°æ¯”å•è°ƒæ ˆè¿˜å¿«ã€‚ã€‚

```java
public int largestRectangleArea(int[] heights) {
    if (heights==null || heights.length<=0) {
        return 0;
    }
    return largestRectangleArea(heights,0,heights.length-1);
}

public int largestRectangleArea(int[] heights,int left,int right) {
    if (left>right) {
        return 0;
    }
    int minIndex=left;
    boolean up=true;
    boolean down=true;
    for (int i=left+1;i<=right;i++) {
        if (heights[i]<heights[i-1]) {
            up=false;
        }
        if (heights[i]>heights[i-1]) {
            down=false;
        }
        minIndex=heights[i]<heights[minIndex]?i:minIndex;
    }
    if (up) {
        int maxArea=-1;
        for (int i=left;i<=right;i++) {
            maxArea=Math.max(maxArea,(right-i+1)*heights[i]);
        }
        return maxArea;
    }
    if (down) {
        int maxArea=-1;
        for (int i=right;i>=left;i--) {
            maxArea=Math.max(maxArea,(i-left+1)*heights[i]);
        }
        return maxArea;
    }
    return Math.max(heights[minIndex]*(right-left+1),Math.max(largestRectangleArea(heights,minIndex+1,right),largestRectangleArea(heights,left,minIndex-1)));
}
```
å…¶å®ç›¸æ¯”äºä¸Šé¢çš„åˆ†æ²»ï¼Œå°±æ˜¯å¤šäº†ä¸€æ­¥åˆ¤æ–­å½“å‰åŒºé—´æ˜¯å¦æœ‰åºï¼Œå› ä¸ºæœ‰åºçš„è¯å°±å¯ä»¥ç›´æ¥éå†å¾—åˆ°åŒºé—´çš„æœ€å¤§çŸ©å½¢ï¼Œä¸ç”¨å†é€’å½’åšåˆ†æ²»ï¼Œæˆ‘è¿™é‡Œåšäº†ä¸¤ä¸ªæœ‰åºçš„åˆ¤æ–­ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æœ‰çš„å¤šä½™ï¼Œæˆ‘çœ‹çš„è¯„è®ºéƒ½åªæœ‰ä¸€ä¸ª

## [85. æœ€å¤§çŸ©å½¢](https://leetcode-cn.com/problems/maximal-rectangle/)

ç»™å®šä¸€ä¸ªä»…åŒ…å« 0 å’Œ 1 çš„äºŒç»´äºŒè¿›åˆ¶çŸ©é˜µï¼Œæ‰¾å‡ºåªåŒ…å« 1 çš„æœ€å¤§çŸ©å½¢ï¼Œå¹¶è¿”å›å…¶é¢ç§¯ã€‚

**ç¤ºä¾‹:**

```java
è¾“å…¥:
[
  ["1","0","1","0","0"],
  ["1","0","1","1","1"],
  ["1","1","1","1","1"],
  ["1","0","0","1","0"]
]
è¾“å‡º: 6
```

**è§£æ³•ä¸€**

ç‰¹æ„åœ¨åšäº†ä¸Šé¢ä¸€é¢˜åæ²¡æœ‰é©¬ä¸Šåšè¿™ä¸€é¢˜ï¼Œä¸‹é¢çš„æ˜¯ç¬¬äºŒå¤©ä¸‹åˆåšçš„ï¼Œè¿˜è¡Œï¼Œæ²¡å¿˜è®°ğŸ˜‚ï¼Œå°±æ˜¯å†™çš„æœ‰ç‚¹éš¾çœ‹

```java
//update: 2020.4.12
public int maximalRectangle(char[][] matrix) {
    if(matrix==null || matrix.length<=0) return 0;
    int M=matrix.length,N=matrix[0].length;
    int[][] height=new int[M][N+1]; //æ¯ä¸€å±‚å¤šåŠ ä¸€ä¸ª0,æ–¹ä¾¿åé¢å‡ºæ ˆ
    int res=0;
    for(int i=0;i<M;i++){
        for(int j=0;j<N;j++){
            if(matrix[i][j]=='1'){
                height[i][j]=i-1>=0?height[i-1][j]+1:1;
            }
        }
        res=Math.max(maxRectangle(height[i]),res);
    }
    return res;
}

public int maxRectangle(int[] height){
    Deque<Integer> stack=new ArrayDeque<>();
    int max=0;
    for(int i=0;i<height.length;i++){
        while(!stack.isEmpty() && height[i]<height[stack.peek()]){
            int cur=stack.pop();
            //æ ˆä¸ºç©ºçš„æ—¶å€™è¯´æ˜å·¦è¾¹çš„å…¨éƒ¨æ˜¯æ¯”å½“å‰æ ˆé¡¶å¤§çš„å…ƒç´ ,å¯ä»¥ç›´æ¥æ‰©å±•åˆ°0,æ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯-1
            int left=stack.isEmpty()?-1:stack.peek();
            //left+1 ~ i-1 = i-1-left
            max=Math.max((i-1-left)*height[cur],max);
        }
        stack.push(i);
    }
    return max;
}
```

å…¶å®è®¡ç®—heightæœ‰ä¸€ç‚¹åŠ¨æ€è§„åˆ’çš„æ„æ€ï¼Œæˆ‘ä¸Šé¢ç›¸å½“äºå†™äº†ä¸ªäºŒç»´çš„åŠ¨æ€è§„åˆ’

> 2020.4.12é‡å†™äº†ä¸€éï¼Œç„¶åæ›´æ–°äº†ä»£ç ï¼Œä¹‹å‰çš„ä»£ç ä¸å¤Ÿç®€æ´

**è§£æ³•äºŒ**

```java
public int maximalRectangle(char[][] matrix) {
    if (matrix==null || matrix.length<=0) {
        return 0;
    }
    //åˆå§‹åŒ–heightæ•°ç»„,åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ (é»˜è®¤0)è®©æ‰€æœ‰å…ƒç´ å¯ä»¥å‡ºæ ˆ
    int[] height=new int[matrix[0].length+1];
    int max=0;
    //è®°å½•æ¯ä¸€å±‚çš„height
    for (int i=0;i<matrix.length;i++) {
        for (int j=0;j<matrix[0].length;j++) {
            height[j]=matrix[i][j]=='1'?height[j]+1:0;
        }
        max=Math.max(max,maxArea(height));
    }
    return max;
}
```

`maxArea`å¯ä»¥ç›´æ¥é‡‡ç”¨ä¸Šé¢84é¢˜çš„åˆ†æ²»

## [581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„](https://leetcode-cn.com/problems/shortest-unsorted-continuous-subarray/)

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½ éœ€è¦å¯»æ‰¾ä¸€ä¸ª**è¿ç»­çš„å­æ•°ç»„**ï¼Œå¦‚æœå¯¹è¿™ä¸ªå­æ•°ç»„è¿›è¡Œå‡åºæ’åºï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„éƒ½ä¼šå˜ä¸ºå‡åºæ’åºã€‚

ä½ æ‰¾åˆ°çš„å­æ•°ç»„åº”æ˜¯**æœ€çŸ­**çš„ï¼Œè¯·è¾“å‡ºå®ƒçš„é•¿åº¦ã€‚

**ç¤ºä¾‹ 1:**

```java
è¾“å…¥: [2, 6, 4, 8, 10, 9, 15]
è¾“å‡º: 5
è§£é‡Š: ä½ åªéœ€è¦å¯¹ [6, 4, 8, 10, 9] è¿›è¡Œå‡åºæ’åºï¼Œé‚£ä¹ˆæ•´ä¸ªè¡¨éƒ½ä¼šå˜ä¸ºå‡åºæ’åºã€‚
```

**è¯´æ˜ :**

1. è¾“å…¥çš„æ•°ç»„é•¿åº¦èŒƒå›´åœ¨ [1, 10,000]ã€‚
2. è¾“å…¥çš„æ•°ç»„å¯èƒ½åŒ…å«**é‡å¤**å…ƒç´  ï¼Œæ‰€ä»¥**å‡åº**çš„æ„æ€æ˜¯**<=ã€‚**

**è§£æ³•ä¸€**

~~å•è°ƒæ ˆçš„è§£æ³•æ˜å¤©å†å†™~~

é¸½äº†æŒºé•¿æ—¶é—´ï¼Œå•è°ƒæ ˆçš„è§£æ³•è¿˜æ˜¯æŒºå¥½çš„

```java
public int findUnsortedSubarray(int[] nums) {
    Stack<Integer> stack=new Stack<>();
    int left=Integer.MAX_VALUE,right=Integer.MIN_VALUE;
    for (int i=0;i<nums.length;i++) {
        while(!stack.isEmpty() && nums[stack.peek()]>nums[i]){
            left=Math.min(stack.pop(),left); //å·¦è¾¹ç•Œæ­£ç¡®ä½ç½®(æœ€å°å€¼)
        }
        stack.push(i);
    }
    stack.clear();
    for (int i=nums.length-1;i>=0;i--) {
        while(!stack.isEmpty() && nums[stack.peek()]<nums[i]){
            right=Math.max(stack.pop(),right); //å³è¾¹ç•Œæ­£ç¡®ä½ç½®(æœ€å¤§å€¼)
        }
        stack.push(i);
    }
    return left>right?0:right-left+1;
}
```

ç¬¬ä¸€ä¸ªå•è°ƒæ ˆä¸­å­˜çš„æ˜¯ä»å·¦åˆ°å³é€’å¢çš„åºåˆ—ï¼Œå½“é‡åˆ°`nums[i]`å°äºæ ˆé¡¶æ—¶ï¼Œè¯´æ˜è¿™ä¸ªä½ç½®æ˜¯é”™ä½çš„ï¼Œæ­£ç¡®çš„ä½ç½®åº”è¯¥æ˜¯**æ ˆé¡¶çš„å…ƒç´ **çš„ä½ç½®ï¼Œæˆ‘ä»¬è¿™é‡Œæ±‚çš„å°±æ˜¯ä¸€ä¸ª**æœ€å°çš„é”™ä½çš„ç´¢å¼•**

ç¬¬äºŒä¸ªå•è°ƒæ ˆä¸­å­˜çš„æ˜¯ä»å³å‘å·¦é€’å‡çš„åºåˆ—ï¼Œå½“é‡åˆ°`nums[i]`å¤§äºæ ˆé¡¶æ—¶ï¼Œè¯´æ˜è¿™ä¸ªä½ç½®æ˜¯é”™ä½çš„ï¼Œæ­£ç¡®çš„ä½ç½®åº”è¯¥æ˜¯**æ ˆé¡¶çš„å…ƒç´ **ï¼Œè¿™é‡Œæ±‚çš„å°±æ˜¯ä¸€ä¸ª**æœ€å¤§çš„é”™ä½çš„ç´¢å¼•** ï¼Œä¸¤è€…ä¹‹é—´çš„è·ç¦»å…¶å®å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆè¦æ±‚çš„æœ€çŸ­æ— åºå­æ•°ç»„é•¿åº¦

**è§£æ³•äºŒ**

å…¶å®å’Œä¸Šé¢çš„å•è°ƒæ ˆçš„æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ‰¾ç¬¬ä¸€ä¸ªï¼ˆæœ€å°ï¼‰å’Œæœ€åä¸€ä¸ªï¼ˆæœ€å¤§ï¼‰é”™ä½çš„å…ƒç´ ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬æ±‚å‡ºé”™ä½çš„å…ƒç´ åè¿˜éœ€è¦å†éå†æ‰¾åˆ°åŸæœ¬æ­£ç¡®çš„ä½ç½®ï¼Œ

```java
//O(1)ç©ºé—´çš„è§£æ³•
public int findUnsortedSubarray(int[] nums) {
    if (nums[0]>nums[nums.length-1]) {
        return nums.length;
    }
    int max=Integer.MIN_VALUE,min=Integer.MAX_VALUE;
    for (int i=1;i<nums.length;i++) {
        if (nums[i]<nums[i-1]) {
            min=Math.min(min,nums[i]); //æ— åºåºåˆ—ä¸­çš„æœ€å°å€¼
        }
    }

    for (int i=nums.length-1;i>0;i--) {
        if (nums[i]<nums[i-1]) {
            max=Math.max(max,nums[i-1]); //æ— åºåºåˆ—ä¸­çš„æœ€å¤§å€¼
        }
    }
    int left=0,right=nums.length-1;
    while(left<nums.length){
        if (nums[left]>min) {
            break;
        }
        left++; //å·¦è¾¹ç•Œæ­£ç¡®ä½ç½®
    }
    while(right>=0){
        if (nums[right]<max) {
            break;
        }
        right--; //å³è¾¹ç•Œæ­£ç¡®ä½ç½®
    }
    return right<left?0:right-left+1;
}
```

## [42. æ¥é›¨æ°´](https://leetcode-cn.com/problems/trapping-rain-water/)

ç»™å®š *n* ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

![rainwatertrap.png](https://i.loli.net/2019/05/14/5cda71129045d93180.png)




ä¸Šé¢æ˜¯ç”±æ•°ç»„ `[0,1,0,2,1,0,1,3,2,1,2,1]` è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ 6 ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚

**ç¤ºä¾‹:**

```java
è¾“å…¥: [0,1,0,2,1,0,1,3,2,1,2,1]
è¾“å‡º: 6
```

**è§£æ³•ä¸‰**

å•è°ƒæ ˆè§£æ³•ï¼ŒåŒæŒ‡é’ˆçš„è§£æ³•æ”¾åœ¨[æ•°ç»„ä¸“é¢˜](http://imlgw.top/2019/05/04/leetcode-shu-zu/#42-%E6%8E%A5%E9%9B%A8%E6%B0%B4)ä¸­ï¼Œå…¶å®æˆ‘æ„Ÿè§‰ç†Ÿæ‚‰å•è°ƒæ ˆçš„è¯ï¼Œå•è°ƒæ ˆçš„è§£æ³•ä¼šæ¯”å…¶ä»–æ–¹æ³•æ›´å¥½ç†è§£

```java
public static int trap6(int[] height) {
    if (height == null || height.length == 0) return 0;
    Deque<Integer> stack = new ArrayDeque<>(); //æ ˆé‡Œé¢ç»´æŠ¤ä¸€ä¸ªé€’å‡åºåˆ—
    int res = 0;
    for (int i = 0; i < height.length; i++){
        while ( ! stack.isEmpty() && height[stack.peek()] < height[i]) { //å½“éå†çš„å…ƒç´ å¤§äºæ ˆé¡¶å…ƒç´ 
            int tmp = stack.pop(); //æ ˆé¡¶å¼¹å‡ºæ¥
            if (stack.isEmpty()) break;
            res += (Math.min(height[i],height[stack.peek()]) - height[tmp]) * (i - stack.peek() - 1);
        }
        //ç»´æŠ¤é€’å‡åºåˆ—
        stack.push(i);
    }
    return res;
}
```

å•è°ƒé€’å‡æ ˆï¼Œæ ˆä¸­å­˜æŸ±å­çš„ç´¢å¼•ï¼Œå½“é‡åˆ°å¤§äºæ ˆé¡¶çš„å…ƒç´ çš„æ—¶å€™å°±å¼€å§‹å¼¹æ ˆï¼Œè®¡ç®—**æ ˆé¡¶å…ƒç´ å’Œå·¦å³é¦–ä¸ªå¤§äºæ ˆé¡¶å…ƒç´ çš„æ‰€èƒ½æ„æˆçš„é‚£ä¸€å±‚çš„æ¥æ°´é‡**ï¼Œå¯¹åº”ä¸‹é¢çš„å›¾ç†è§£å°±æ˜¯

**`(Math.min(height[i],height[stack.peek()])-curTop) * (i-stack.peek()-1)`**

![mark](http://static.imlgw.top/blog/20200129/f0b4lo2Xk5Q3.png?imageslim)

ä¾æ¬¡è®¡ç®—â‘ â‘¡â‘¢ä½ç½®çš„é¢ç§¯ï¼Œè¿™æ ·çš„æ€è·¯æ„Ÿè§‰ä¼šæ›´åŠ çš„è‡ªç„¶

## [é¢è¯•é¢˜33. äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ—](https://leetcode-cn.com/problems/er-cha-sou-suo-shu-de-hou-xu-bian-li-xu-lie-lcof/)

è¾“å…¥ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­è¯¥æ•°ç»„æ˜¯ä¸æ˜¯æŸäºŒå‰æœç´¢æ ‘çš„ååºéå†ç»“æœã€‚å¦‚æœæ˜¯åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚å‡è®¾è¾“å…¥çš„æ•°ç»„çš„ä»»æ„ä¸¤ä¸ªæ•°å­—éƒ½äº’ä¸ç›¸åŒã€‚

å‚è€ƒä»¥ä¸‹è¿™é¢—äºŒå‰æœç´¢æ ‘ï¼š

```java
     5
    / \
   2   6
  / \
 1   3
```
**ç¤ºä¾‹ 1ï¼š**

```java
è¾“å…¥: [1,6,3,2,5]
è¾“å‡º: false
```

**ç¤ºä¾‹ 2ï¼š**

```java
è¾“å…¥: [1,3,2,6,5]
è¾“å‡º: true
```

**æç¤ºï¼š**

1. `æ•°ç»„é•¿åº¦ <= 1000`

**è§£æ³•ä¸€**

å•è°ƒæ ˆçš„è§£æ³•

```java
public boolean verifyPostorder(int[] postorder) {
    if(postorder==null || postorder.length<=0) return true;
    Deque<Integer> stack=new ArrayDeque<>();
    //1 2 | 4 5 | 3
    int curRoot=Integer.MAX_VALUE;
    for(int i=postorder.length-1;i>=0;i--){
        if(postorder[i]>curRoot){
            return false;
        }
        while(!stack.isEmpty() && postorder[i]<postorder[stack.peek()]){
            curRoot=postorder[stack.pop()];
        }
        stack.push(i);
    }
    return true;
}
```

é€†åºéå†è¿™ä¸ªåºåˆ—ï¼Œå°±æ˜¯ `root -- root.right -- root.left` ï¼Œç”¨ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼Œå½“é‡åˆ°å‡å°çš„å€¼å°±è¯´æ˜è¿›å…¥äº†å·¦å­æ ‘ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿™é¢—æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸åœå‡ºæ ˆï¼Œç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œç„¶åç»§ç»­å‘ååˆ¤æ–­å·¦å­æ ‘æ˜¯ä¸æ˜¯éƒ½å°äºè¿™ä¸ªæ ¹èŠ‚ç‚¹çš„

## [é¢è¯•é¢˜59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼](https://leetcode-cn.com/problems/dui-lie-de-zui-da-zhi-lcof/)

è¯·å®šä¹‰ä¸€ä¸ªé˜Ÿåˆ—å¹¶å®ç°å‡½æ•° max_value å¾—åˆ°é˜Ÿåˆ—é‡Œçš„æœ€å¤§å€¼ï¼Œè¦æ±‚å‡½æ•°max_valueã€push_back å’Œ pop_front çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚

è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œ`pop_front` å’Œ `max_value` éœ€è¦è¿”å› -1

**ç¤ºä¾‹ 1ï¼š**

```java
è¾“å…¥: 
["MaxQueue","push_back","push_back","max_value","pop_front","max_value"]
[[],[1],[2],[],[],[]]
è¾“å‡º: [null,null,null,2,1,2]
```

**ç¤ºä¾‹ 2ï¼š**

```java
è¾“å…¥: 
["MaxQueue","pop_front","max_value"]
[[],[],[]]
è¾“å‡º: [null,-1,-1]
```

**é™åˆ¶ï¼š**

- `1 <= push_back,pop_front,max_valueçš„æ€»æ“ä½œæ•° <= 10000`
- `1 <= value <= 10^5`

**è§£æ³•ä¸€**

```java
public MaxQueue() {

}

Deque<Integer> queue=new LinkedList<>();

Deque<Integer> maxQueue=new ArrayDeque<>();

public int max_value() {
    return maxQueue.isEmpty()?-1:maxQueue.getFirst();
}

public void push_back(int value) {
    queue.addLast(value);
    while(!maxQueue.isEmpty() && value>maxQueue.getLast()){
        maxQueue.removeLast();
    }
    maxQueue.addLast(value);
}

public int pop_front() {
    if(queue.isEmpty()) return -1;
    int temp=queue.removeFirst();
    if(temp==maxQueue.getFirst()){
        maxQueue.removeFirst();
    }
    return temp;
}
```

ä¸€ç›´ä»¥ä¸ºæ˜¯å’Œæœ€å°æ ˆä¸€æ ·ï¼Œç»“æœWAäº†ä¸¤å‘æ‰æ„è¯†åˆ°æé”™äº†ã€‚ã€‚ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿›å‡ºæ–¹å‘æ˜¯ä¸ä¸€æ ·çš„

å…¶å®è¿™é¢˜å’Œä¹‹å‰çš„ä¸€é“ [æ»‘åŠ¨çª—å£æœ€å¤§å€¼](http://imlgw.top/2019/07/20/leetcode-hua-dong-chuang-kou/#239-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%80%E5%A4%A7%E5%80%BC) ä¸€æ ·ï¼Œç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡çš„å•è°ƒæ ˆç„¶åç»´æŠ¤è¿™ä¸ªå•è°ƒæ ˆå°±è¡Œäº†

## [5402. ç»å¯¹å·®ä¸è¶…è¿‡é™åˆ¶çš„æœ€é•¿è¿ç»­å­æ•°ç»„](https://leetcode-cn.com/problems/longest-continuous-subarray-with-absolute-diff-less-than-or-equal-to-limit/) 

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ï¼Œå’Œä¸€ä¸ªè¡¨ç¤ºé™åˆ¶çš„æ•´æ•° `limit`ï¼Œè¯·ä½ è¿”å›æœ€é•¿è¿ç»­å­æ•°ç»„çš„é•¿åº¦ï¼Œè¯¥å­æ•°ç»„ä¸­çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„ç»å¯¹å·®å¿…é¡»å°äºæˆ–è€…ç­‰äº `limit` *ã€‚*

å¦‚æœä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„ï¼Œåˆ™è¿”å› `0` ã€‚

**ç¤ºä¾‹ 1ï¼š**

```java
è¾“å…¥ï¼šnums = [8,2,4,7], limit = 4
è¾“å‡ºï¼š2 
è§£é‡Šï¼šæ‰€æœ‰å­æ•°ç»„å¦‚ä¸‹ï¼š
[8] æœ€å¤§ç»å¯¹å·® |8-8| = 0 <= 4.
[8,2] æœ€å¤§ç»å¯¹å·® |8-2| = 6 > 4. 
[8,2,4] æœ€å¤§ç»å¯¹å·® |8-2| = 6 > 4.
[8,2,4,7] æœ€å¤§ç»å¯¹å·® |8-2| = 6 > 4.
[2] æœ€å¤§ç»å¯¹å·® |2-2| = 0 <= 4.
[2,4] æœ€å¤§ç»å¯¹å·® |2-4| = 2 <= 4.
[2,4,7] æœ€å¤§ç»å¯¹å·® |2-7| = 5 > 4.
[4] æœ€å¤§ç»å¯¹å·® |4-4| = 0 <= 4.
[4,7] æœ€å¤§ç»å¯¹å·® |4-7| = 3 <= 4.
[7] æœ€å¤§ç»å¯¹å·® |7-7| = 0 <= 4. 
å› æ­¤ï¼Œæ»¡è¶³é¢˜æ„çš„æœ€é•¿å­æ•°ç»„çš„é•¿åº¦ä¸º 2 ã€‚
```

**ç¤ºä¾‹ 2ï¼š**

```java
è¾“å…¥ï¼šnums = [10,1,2,4,7,2], limit = 5
è¾“å‡ºï¼š4 
è§£é‡Šï¼šæ»¡è¶³é¢˜æ„çš„æœ€é•¿å­æ•°ç»„æ˜¯ [2,4,7,2]ï¼Œå…¶æœ€å¤§ç»å¯¹å·® |2-7| = 5 <= 5 ã€‚
```

**ç¤ºä¾‹ 3ï¼š**

```java
è¾“å…¥ï¼šnums = [4,2,2,2,4,4,2,2], limit = 0
è¾“å‡ºï¼š3
```

**æç¤ºï¼š**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`
- `0 <= limit <= 10^9`

187thå‘¨èµ›t3ï¼Œæ—¶éš”è¿™ä¹ˆä¹…åˆå›å¤´æ‰“ä¸€æ¬¡å‘¨èµ›ï¼Œå¯æƒœï¼Œåˆåªåšäº†ä¸¤é¢˜ï¼Œå‰ä¸¤é¢˜10åˆ†é’Ÿä¸åˆ°å°±å†™å®Œäº†ï¼Œå¿ƒæƒ³è¿™å›æ€ä¹ˆè¯´ä¹Ÿå¾—åšä¸ª3é¢˜ï¼Œç»“æœã€‚ã€‚ã€‚

**è§£æ³•ä¸€**

```java
public int longestSubarray2(int[] nums, int limit) {
    if (nums==null || nums.length<=0) {
        return 0;
    }
    int left=0,right=0;
    int min=0,max=0;
    int res=1;
    PriorityQueue<Integer> minpq=new PriorityQueue<>();
    minpq.add(nums[0]);
    PriorityQueue<Integer> maxpq=new PriorityQueue<>((a,b)->b-a);
    maxpq.add(nums[0]);
    //7 2
    while(left<=right && right<nums.length){
        while (right< nums.length && maxpq.peek()-minpq.peek()<=limit) {
            res=Math.max(right-left+1,res);
            right++;
            if (right<nums.length) {
                maxpq.add(nums[right]);
                minpq.add(nums[right]);   
            }
        }
        maxpq.remove(nums[left]);
        minpq.remove(nums[left]);
        left++;
    }
    return res;
}
```
è¿™ä¸ªæ˜¯å½“æ—¶æ¯”èµ›è°ƒäº†åŠå¤©æ²¡è°ƒå‡ºæ¥ï¼Œç»“æŸä¹‹åè°ƒå‡ºæ¥çš„ä»£ç ï¼Œç”¨ä¸¤ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤åŒºé—´æœ€å€¼ï¼Œç„¶åæ»‘çª—å°±è¡Œäº†ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯è°ƒæ»‘çª—çš„æ—¶å€™è°ƒäº†åŠå¤©ï¼Œä¹‹å‰å†™æ»‘çª—å°±æ˜¯ä¹±å†™çš„ï¼Œæ²¡ä»€ä¹ˆç« æ³•ï¼Œè¾¹WAè¾¹æ”¹ï¼Œçœ‹æ¥æœ€è¿‘å¾—å¥½å¥½æ€»ç»“ä¸‹æ»‘çª—çš„é¢˜äº†ï¼Œå¾—æä¸ªæ¿å­å‡ºæ¥

**è§£æ³•äºŒ**

æœ€ä¼˜è§£ï¼ŒO(N)å•è°ƒé˜Ÿåˆ—
```java
//UPDATE: 2020/6/29 æ”¹æˆæœ€è¿‘æ€»ç»“çš„for-whileæ»‘çª—æ¨¡æ¿
//ä¸Šé¢çš„è§£æ³•ä¸€çš„æ»‘çª—ä¹Ÿå†™çš„ä¸å¥½ï¼Œæœ‰æ—¶é—´æ”¹æ”¹
public int longestSubarray(int[] nums, int limit) {
    if (nums==null || nums.length<=0) {
        return 0;
    }
    int left=0;
    int min=0,max=0;
    int res=1;
    //å•è°ƒé˜Ÿåˆ—è®°å½•åŒºé—´æœ€å€¼ç´¢å¼•
    LinkedList<Integer> maxQue=new LinkedList<>();
    LinkedList<Integer> minQue=new LinkedList<>();
    for(int right=0;right<nums.length;right++){
        while(!maxQue.isEmpty() && nums[maxQue.getLast()]<nums[right]){
            maxQue.removeLast();
        }
        maxQue.addLast(right);
        while(!minQue.isEmpty() && nums[minQue.getLast()]>nums[right]){
            minQue.removeLast();
        }
        minQue.addLast(right);
        while(nums[maxQue.getFirst()]-nums[minQue.getFirst()]>limit) {
            //ä¸ç¬¦åˆè¦æ±‚ï¼Œå·¦è¾¹ç•Œå·¦ç§»ï¼Œå½“å·¦è¾¹ç•Œæ˜¯æœ€å€¼çš„æ—¶å€™queå¼¹å‡º
            if (left==maxQue.getFirst()) maxQue.removeFirst();
            if (left==minQue.getFirst()) minQue.removeFirst();
            left++;
        }
        res=Math.max(res,right-left+1);
    }
    return res;
}
```
å…¶å®å½“æ—¶æˆ‘ç¡®å®ä¹Ÿå°è¯•å»ç”¨ä¸¤ä¸ªå•è°ƒé˜Ÿåˆ—ç»´æŠ¤æœ€å€¼ï¼Œä½†æ˜¯ï¼ï¼ï¼è¿˜æ˜¯è¢«æ»‘çª—çš„è¾¹ç•Œç»™æå¾—ä¸çŸ¥é“è¿™ä¹ˆå†™äº†ï¼Œç„¶åå°±æ²¡åˆç„¶åäº†ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯æ¯”èµ›å®Œä¹‹åè‡ªå·±å†™å‡ºæ¥çš„ï¼Œè¯´åˆ°åº•è¿˜æ˜¯èœå•Šï¼ğŸ˜­

## [962. æœ€å¤§å®½åº¦å¡](https://leetcode-cn.com/problems/maximum-width-ramp/) 

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `A`ï¼Œ*å¡*æ˜¯å…ƒç»„ `(i, j)`ï¼Œå…¶ä¸­  `i < j` ä¸” `A[i] <= A[j]`ã€‚è¿™æ ·çš„å¡çš„å®½åº¦ä¸º `j - i`ã€‚

æ‰¾å‡º `A` ä¸­çš„å¡çš„æœ€å¤§å®½åº¦ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚

**ç¤ºä¾‹ 1ï¼š**

```java
è¾“å…¥ï¼š[6,0,8,2,1,5]
è¾“å‡ºï¼š4
è§£é‡Šï¼š
æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (1, 5): A[1] = 0 ä¸” A[5] = 5.
```

**ç¤ºä¾‹ 2ï¼š**

```java
è¾“å…¥ï¼š[9,8,1,0,1,9,4,0,4,1]
è¾“å‡ºï¼š7
è§£é‡Šï¼š
æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (2, 9): A[2] = 1 ä¸” A[9] = 1.
```

**æç¤ºï¼š**

1. `2 <= A.length <= 50000`
2. `0 <= A[i] <= 50000`

**è§£æ³•ä¸€**

æƒ³ä¸åˆ°ï¼Œç€å®æƒ³ä¸åˆ°ï¼Œè¿™ä¸ªå•è°ƒæ ˆçš„ç”¨æ³•ç¡®å®æ²¡è§è¿‡

```java
public int maxWidthRamp(int[] A) {
    Deque<Integer> stack=new ArrayDeque<>();
    int res=0;
    for(int i=0;i<A.length;i++){
        if(stack.isEmpty() || A[stack.peek()]>A[i]){
            stack.push(i);
        }
    }
    for(int i=A.length-1;i>=0;i--){
        while(!stack.isEmpty() && A[stack.peek()]<=A[i]){
            int cur=stack.pop();
            res=Math.max(res,i-cur);
        }
    }
    return res;
}
```

é¦–å…ˆæŠŠAæ•°ç»„ä¸­çš„ä»¥`A[0]`å¼€å¤´çš„é€’å‡åºåˆ—æŠ½å–å‡ºæ¥ï¼Œæˆ‘ä»¬æœ€åè¦æ±‚çš„æœ€å¤§çš„å®½åº¦å¡ä¸€å®šæ˜¯ä»¥è¿™ä¸ªåºåˆ—ä¸­çš„æŸä¸€ä¸ª`i`ä¸º**å¡åº•**çš„ï¼Œæˆ‘ä»¬åè¯ä¸€ä¸‹

å‡è®¾å­˜åœ¨æŸä¸ªå…ƒç´ ä½ç½®`k`ä¸å­˜åœ¨äºä¸Šé¢çš„é€’å‡åºåˆ—ä¸­ï¼Œä¸”æœ‰æœ€å¤§å®½åº¦`j-k`ï¼Œè¿™ä¹Ÿå°±è¯´æ˜`k`ä½ç½®çš„å…ƒç´ **ä¸€å®šæ˜¯å°äºç­‰äºkå‰é¢æ‰€æœ‰çš„å…ƒç´ çš„**ï¼Œå¦åˆ™å°±ä¼šæœ‰æ›´é•¿çš„å®½åº¦ï¼Œä½†æ˜¯æ—¢ç„¶`k`å°äºç­‰äºå‰é¢æ‰€æœ‰çš„å…ƒç´ ï¼Œé‚£ä¹ˆkå°±ä¸€å®šä¼šè¢«åŠ å…¥åˆ°åºåˆ—ä¸­ï¼Œä¸å‡è®¾çŸ›ç›¾ï¼Œæ‰€ä»¥ä¸å­˜åœ¨kï¼Œè§£ä¸€å®šå­˜åœ¨é€’å‡åºåˆ—ä¸­

è¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥é€†å‘éå†æ•°ç»„ï¼Œæ¯æ¬¡é‡åˆ°å…ƒç´ å¤§äºæ ˆé¡¶çš„å°±å¯ä»¥è®¡ç®—å®½åº¦ï¼Œç„¶åå°†æ ˆé¡¶å¼¹å‡ºï¼Œå› ä¸ºæ˜¯é€†åºéå†çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå®½åº¦ä¸€å®šæ˜¯æ ˆé¡¶è¿™ä¸ª**å¡åº•i**èƒ½å½¢æˆçš„æœ€å¤§å®½åº¦äº†ï¼Œ é€†åºéå†å†å¾€å‰çš„è¯å³ä½¿å¤§äºè¿™ä¸ªæ ˆé¡¶ï¼Œå½¢æˆçš„å®½åº¦ä¹Ÿåªä¼šå‡å°ï¼Œæ‰€ä»¥è¿™ä¸ªæ ˆé¡¶æ˜¯å¯ä»¥ç›´æ¥`pop`å‡ºå»çš„ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰çš„å¡åº•æ±‚æœ€å¤§å€¼å°±è¡Œäº†ï¼Œæ—¶é—´å¤æ‚åº¦`O(N)`

**è§£æ³•äºŒ**

äºŒåˆ†çš„æ€è·¯ï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼Œå…ˆæ„å»ºä¸€ä¸ªä»¥`A[0]`å¼€å¤´çš„é€’å‡åºåˆ—ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬æ‰€æœ‰çš„å¡åº•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥éå†æ‰€æœ‰çš„å…ƒç´ ï¼Œç„¶ååœ¨è¿™ä¸ªå•è°ƒåºåˆ—ä¸­å¯»æ‰¾ç¬¬ä¸€ä¸ªå°äºç­‰äºå½“å‰å…ƒç´ çš„`index`ï¼Œè¿™ä¸¤ä¸ªæ„æˆçš„å®½åº¦å°±æ˜¯**å½“å‰å…ƒç´ **æ‰€èƒ½å½¢æˆçš„æœ€å¤§å®½åº¦ï¼Œæˆ‘ä»¬æ±‚å‡ºæ‰€æœ‰çš„æœ€å¤§å®½åº¦å–ä¸€ä¸ªæœ€å€¼å°±å¯ä»¥äº†ï¼Œæ—¶é—´å¤æ‚åº¦`O(NlogN)`

```go
func maxWidthRamp(A []int) int {
    var order [][]int
    order = append(order, []int{0, A[0]})
    //æ„å»ºé€’å‡åºåˆ—
    for i := 1; i < len(A); i++ {
        if A[i] < order[len(order)-1][1] {
            order = append(order, []int{i, A[i]})
        }
    }
    res := 0
    for j, target := range A {
        i := binarySearch(order, target)
        res = Max(res, j-i)
    }
    return res
}

//æ‰¾ç¬¬ä¸€ä¸ªå°äºç­‰äºtargetçš„å€¼
func binarySearch(num [][]int, target int) int {
    left := 0
    right := len(num) - 1
    for left < right {
        mid := left + (right-left)/2
        if num[mid][1] > target {
            left = mid + 1 //æ³¨æ„æ˜¯é€’å‡åºåˆ—
        } else {
            right = mid
        }
    }
    return num[left][0]
}

func Max(a, b int) int {
    if a > b {
        return a
    }
    return b
}
```

> åœ¨lcå†™çš„ [é¢˜è§£](https://leetcode-cn.com/problems/maximum-width-ramp/solution/java-dan-diao-zhan-er-fen-jie-fa-chang-shi-jie-shi/)æ¬¢è¿å‰æ¥çº é”™

## [1124. è¡¨ç°è‰¯å¥½çš„æœ€é•¿æ—¶é—´æ®µ](https://leetcode-cn.com/problems/longest-well-performing-interval/)

ç»™ä½ ä¸€ä»½å·¥ä½œæ—¶é—´è¡¨ `hours`ï¼Œä¸Šé¢è®°å½•ç€æŸä¸€ä½å‘˜å·¥æ¯å¤©çš„å·¥ä½œå°æ—¶æ•°ã€‚

æˆ‘ä»¬è®¤ä¸ºå½“å‘˜å·¥ä¸€å¤©ä¸­çš„å·¥ä½œå°æ—¶æ•°å¤§äº `8` å°æ—¶çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸€å¤©å°±æ˜¯ã€Œ**åŠ³ç´¯çš„ä¸€å¤©**ã€ã€‚

æ‰€è°“ã€Œè¡¨ç°è‰¯å¥½çš„æ—¶é—´æ®µã€ï¼Œæ„å‘³åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œã€ŒåŠ³ç´¯çš„å¤©æ•°ã€æ˜¯ä¸¥æ ¼ **å¤§äº**ã€Œä¸åŠ³ç´¯çš„å¤©æ•°ã€ã€‚

è¯·ä½ è¿”å›ã€Œè¡¨ç°è‰¯å¥½æ—¶é—´æ®µã€çš„æœ€å¤§é•¿åº¦ã€‚

**ç¤ºä¾‹ 1ï¼š**

```java
è¾“å…¥ï¼šhours = [9,9,6,0,6,6,9]
è¾“å‡ºï¼š3
è§£é‡Šï¼šæœ€é•¿çš„è¡¨ç°è‰¯å¥½æ—¶é—´æ®µæ˜¯ [9,9,6]ã€‚
```

**æç¤ºï¼š**

- `1 <= hours.length <= 10000`
- `0 <= hours[i] <= 16`

**è§£æ³•ä¸€**

æƒ­æ„§ï¼Œè¿™é¢˜è¿˜æ˜¯çœ‹çš„é¢˜è§£ï¼Œè¿™é¢˜è¿˜æ˜¯æŒºå·§å¦™çš„ï¼Œæˆ‘ä»¬æŠŠå¤§äº8å°æ—¶çš„æ—¶é—´æ®µçœ‹ä½œ`+1`ï¼Œå°äº8å°æ—¶çš„çœ‹ä½œ`-1`ï¼Œè¿™æ ·é—®é¢˜å°±è½¬æ¢æˆäº†æ±‚**åŒºé—´å’Œå¤§äº0çš„æœ€é•¿é•¿åº¦**ï¼Œè€ŒåŒºé—´å’Œæˆ‘ä»¬åˆå¯ä»¥è”æƒ³åˆ°ç”¨å‰ç¼€å’Œï¼Œè¿™æ ·æˆ‘ä»¬å°†é¢˜ç›®çš„ä¾‹å­è½¬æ¢ä¸€ä¸‹å°±å˜æˆäº†

```java
hours:    9 9  6  0  6  6  9
hours:  0 1 1 -1 -1 -1 -1  1
  pre:  0 1 2  1  0 -1 -2 -1
```

åªè¦`pre`ä¸­ä¸¤ç‚¹çš„å‰ç¼€`pre[j]-pre[i]>0`å°±è¯´æ˜åŒºé—´`[i+1ï¼Œj]`æ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œæˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯æ»¡è¶³æ¡ä»¶çš„æœ€é•¿å®½åº¦ï¼Œè¿™æ ·ä¸€æ¥é—®é¢˜å…¶å®å°±è½¬æ¢æˆäº†å’Œä¸Šé¢[962.æœ€å¤§å®½åº¦å¡](#962-æœ€å¤§å®½åº¦å¡)ä¸€æ ·äº†ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤æ±‚è§£å°±okäº†

```java
public int longestWPI(int[] hours) {
    int[] pre=new int[hours.length+1];
    for(int i=1;i<=hours.length;i++){
        pre[i]=pre[i-1]+(hours[i-1]>8?1:-1);
    }
    Deque<Integer> stack=new ArrayDeque<>();
    for(int i=0;i<pre.length;i++){
        if(stack.isEmpty() || pre[i]<pre[stack.peek()]){
            stack.push(i);
        }
    }
    int res=0;
    for(int i=pre.length-1;i>=0;i--){
        while(!stack.isEmpty() && pre[i]-pre[stack.peek()]>0){
            res=Math.max(res,i-stack.pop()); //ä¸ç”¨+1
        }
    }
    return res;
}
```

## [907. å­æ•°ç»„çš„æœ€å°å€¼ä¹‹å’Œ](https://leetcode-cn.com/problems/sum-of-subarray-minimums/)

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `A`ï¼Œæ‰¾åˆ° `min(B)` çš„æ€»å’Œï¼Œå…¶ä¸­ `B` çš„èŒƒå›´ä¸º `A` çš„æ¯ä¸ªï¼ˆè¿ç»­ï¼‰å­æ•°ç»„ã€‚

ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œå› æ­¤**è¿”å›ç­”æ¡ˆæ¨¡ 10^9 + 7**ã€‚

**ç¤ºä¾‹ï¼š**

```java
è¾“å…¥ï¼š[3,1,2,4]
è¾“å‡ºï¼š17
è§£é‡Šï¼š
å­æ•°ç»„ä¸º [3]ï¼Œ[1]ï¼Œ[2]ï¼Œ[4]ï¼Œ[3,1]ï¼Œ[1,2]ï¼Œ[2,4]ï¼Œ[3,1,2]ï¼Œ[1,2,4]ï¼Œ[3,1,2,4]ã€‚ 
æœ€å°å€¼ä¸º 3ï¼Œ1ï¼Œ2ï¼Œ4ï¼Œ1ï¼Œ1ï¼Œ2ï¼Œ1ï¼Œ1ï¼Œ1ï¼Œå’Œä¸º 17ã€‚
```

**æç¤ºï¼š**

1. `1 <= A <= 30000`
2. `1 <= A[i] <= 30000`

**è§£æ³•ä¸€**

è™½ç„¶èŠ±äº†æŒºé•¿æ—¶é—´å¥½æ­¹è¿˜æ˜¯è‡ªå·±åšå‡ºæ¥äº†ï¼Œå¼€å¿ƒğŸ˜

```java
public int sumSubarrayMins(int[] A) {
    Deque<Integer> stack=new ArrayDeque<>();
    int N=A.length;
    int mod=(int)1e9+7;
    int res=0;
    int[] temp=new int[N+1];
    System.arraycopy(A,0,temp,0,N);
    //æœ«å°¾åŠ 0ä½¿æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥å‡ºæ ˆ
    temp[N]=0;A=temp; 
    for(int i=0;i<N+1;i++){
        while(!stack.isEmpty() && A[stack.peek()]>A[i]){
            int cur=stack.pop();
            int left=stack.isEmpty()?-1:stack.peek();
            //å³è¾¹å°äºcurçš„ä¸ªæ•°ï¼š i-cur-1
            //å·¦è¾¹å°äºcurçš„ä¸ªæ•°ï¼š cur-(left+1)
            //res=(res+A[cur]*((i-cur-1)*(cur-left-1)+i-1-left))%mod;
            //(a+1)*(b+1)=ab+a+b+1 åŒ–ç®€
            res=(res+A[cur]*(i-cur)*(cur-left))%mod;
        }
        stack.push(i);
    }
    return res;
}
```

æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç»´æŠ¤å•è°ƒé€’å¢æ ˆï¼Œåœ¨æ¯ä¸ªå…ƒç´ å‡ºæ ˆçš„æ—¶å€™è€ƒè™‘å¦‚ä½•è®¡ç®—**ä»¥è¯¥å…ƒç´ ä¸ºåŒºé—´æœ€å°å€¼**çš„åŒºé—´ä¸ªæ•°

 æ¯”å¦‚`[9,8,7,6,1,5,3,4,2]`è¿™ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬è¦æ±‚ä»¥`1`ä¸ºåŒºé—´æœ€å°å€¼çš„åŒºé—´ä¸ªæ•°ã€‚

æˆ‘ä»¬åˆ†å¼€æ¥æ±‚ï¼Œå…ˆæ±‚å·¦å³ä¸¤è¾¹çš„ï¼Œå¾ˆæ˜æ˜¾ä»…åŒ…å«`1`å·¦è¾¹æˆ–å³è¾¹å…ƒç´ çš„å­åŒºé—´ä¸ªæ•°æ˜¯4+4=8ä¸ªï¼Œä¹Ÿå°±æ˜¯[6,1] , [7,6,1] ...å’Œ[1,5], [1,5,3]....è¿™äº›åŒºé—´

ç„¶åå†çœ‹åŒæ—¶åŒ…å«`1`å·¦å³ä¸¤è¾¹çš„å…ƒç´ çš„å­åŒºé—´ï¼Œä¸€è¾¹é€‰ä¸€ä¸ªåŒºé—´å’Œå¦ä¸€è¾¹éƒ½ä¼šæœ‰4ç§ç»„åˆï¼Œæ‰€ä»¥å°±æ˜¯4*4=16ç§

æœ€åå†åŠ ä¸Š`1`æœ¬èº«å°±è¡Œäº†ï¼Œæ‰€ä»¥ä»¥`1`ä¸ºåŒºé—´æœ€å°å€¼çš„åŒºé—´ä¸ªæ•°å°±æ˜¯8+16+1=25

> åœ¨çœ‹äº†å¤§ä½¬çš„åšæ³•åå‘ç°ä¸Šé¢çš„æ˜¯å¯ä»¥åŒ–ç®€çš„ï¼š`a*b+a+b+1=(a+1)*(b+1)`


## [5454. ç»Ÿè®¡å…¨ 1 å­çŸ©å½¢](https://leetcode-cn.com/problems/count-submatrices-with-all-ones/)

Difficulty: **ä¸­ç­‰**


ç»™ä½ ä¸€ä¸ªåªåŒ…å« 0 å’Œ 1 çš„Â `rows * columns`Â çŸ©é˜µÂ `mat`Â ï¼Œè¯·ä½ è¿”å›æœ‰å¤šå°‘ä¸ªÂ **å­çŸ©å½¢**Â çš„å…ƒç´ å…¨éƒ¨éƒ½æ˜¯ 1 ã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šmat = [[1,0,1],
Â            [1,1,0],
Â            [1,1,0]]
è¾“å‡ºï¼š13
è§£é‡Šï¼š
æœ‰ 6Â ä¸ª 1x1 çš„çŸ©å½¢ã€‚
æœ‰ 2 ä¸ª 1x2 çš„çŸ©å½¢ã€‚
æœ‰ 3 ä¸ª 2x1 çš„çŸ©å½¢ã€‚
æœ‰ 1 ä¸ª 2x2 çš„çŸ©å½¢ã€‚
æœ‰ 1 ä¸ª 3x1 çš„çŸ©å½¢ã€‚
çŸ©å½¢æ•°ç›®æ€»å…± = 6 + 2 + 3 + 1 + 1 = 13Â ã€‚
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šmat = [[0,1,1,0],
Â            [0,1,1,1],
Â            [1,1,1,0]]
è¾“å‡ºï¼š24
è§£é‡Šï¼š
æœ‰ 8 ä¸ª 1x1 çš„å­çŸ©å½¢ã€‚
æœ‰ 5 ä¸ª 1x2 çš„å­çŸ©å½¢ã€‚
æœ‰ 2 ä¸ª 1x3 çš„å­çŸ©å½¢ã€‚
æœ‰ 4 ä¸ª 2x1 çš„å­çŸ©å½¢ã€‚
æœ‰ 2 ä¸ª 2x2 çš„å­çŸ©å½¢ã€‚
æœ‰ 2 ä¸ª 3x1 çš„å­çŸ©å½¢ã€‚
æœ‰ 1 ä¸ª 3x2 çš„å­çŸ©å½¢ã€‚
çŸ©å½¢æ•°ç›®æ€»å…± = 8 + 5 + 2 + 4 + 2 + 2 + 1 = 24 ã€‚
```

**ç¤ºä¾‹ 3ï¼š**

```go
è¾“å…¥ï¼šmat = [[1,1,1,1,1,1]]
è¾“å‡ºï¼š21
```

**ç¤ºä¾‹ 4ï¼š**

```go
è¾“å…¥ï¼šmat = [[1,0,1],[0,1,0],[1,0,1]]
è¾“å‡ºï¼š5
```

**æç¤ºï¼š**

*   `1 <= rowsÂ <= 150`
*   `1 <= columnsÂ <= 150`
*   `0 <= mat[i][j] <= 1`

**è§£æ³•ä¸€**

196å‘¨èµ›T3ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºéš¾çš„ï¼Œä¸è¿‡æ•°æ®é‡æ¯”è¾ƒå°ï¼Œåªæœ‰150ï¼Œæ‰€ä»¥æš´åŠ›å…¶å®å°±å¯ä»¥

```java
//è§£æ³•ä¸€: N3
public int numSubmat(int[][] mat) {
    int m = mat.length;
    int n = mat[0].length;
    //é¢„å¤„ç†mat[i][j]ä¸Šè¾¹æœ‰å¤šå°‘ä¸ªè¿ç»­çš„1
    int[][] upCnt= new int[m][n];
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < n; j++) {
            if(mat[i][j] == 1){
                upCnt[i][j] = i==0 ? mat[i][j]&1 : upCnt[i-1][j]+1;
            }
        }
    }
    int res = 0;
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < n; j++) {
            if(mat[i][j] == 1){
                int k = j;
                int rowCnt = upCnt[i][j];
                while(k>=0){
                    rowCnt = Math.min(rowCnt, upCnt[i][k]);
                    res += rowCnt;
                    k--;
                }
            }
        }
    }
    return res;
}
```

**è§£æ³•äºŒ**

å•è°ƒæ ˆï¼Œå‚è€ƒäº†ç½‘ä¸Šçš„é¢˜è§£ï¼Œè™½ç„¶è‡ªå·±ææ‡‚äº†ï¼Œä½†æ˜¯æƒ³å†™é¢˜è§£çš„æ—¶å€™æ„Ÿè§‰æœ‰ç‚¹ä¸å¥½æè¿°å•Šï¼Œè¦å†™å¥½å¤šä¸œè¥¿ï¼Œæœ‰ç‚¹æŠ½è±¡ï¼Œä½†æ˜¯æ€è·¯è¿˜æ˜¯éå¸¸å¥½çš„ï¼Œä¹Ÿæ˜¯ä¸ªå¾ˆç»å…¸çš„é¢˜äº†
```java
public int numSubmat(int[][] mat) {
    int m = mat.length;
    int n = mat[0].length;
    //é¢„å¤„ç†mat[i][j]ä¸Šè¾¹æœ‰å¤šå°‘ä¸ªè¿ç»­çš„1
    int[][] upCnt= new int[m][n];
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < n; j++) {
            if(mat[i][j] == 1){
                upCnt[i][j] = i==0 ? mat[i][j]&1 : upCnt[i-1][j]+1;
            }
        }
    }
    //å•è°ƒé€’å¢æ ˆç»´æŠ¤åˆ—çš„é•¿åº¦
    Deque<Integer> stack = new ArrayDeque<>();
    int res = 0;
    for (int i = 0; i < m; i++) {
        stack.clear();
        int ijCnt = 0; //ä»¥i,jä¸ºå³ä¸‹è§’çš„çŸ©å½¢çš„cnt
        for (int j = 0; j < n; j++) {
            ijCnt += upCnt[i][j];
            while(!stack.isEmpty() && upCnt[i][stack.peek()] > upCnt[i][j]){
                int cur = stack.pop();
                //æ ˆä¸­çš„ç´¢å¼•æ˜¯ä»0å¼€å§‹çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¦‚æœæ ˆä¸ºç©ºï¼Œleftåº”è¯¥ä¸º-1
                int left = stack.isEmpty() ? -1 : stack.peek();
                //å‡å»å¤šçš„éƒ¨åˆ†
                ijCnt -= (cur-left) * (upCnt[i][cur] - upCnt[i][j]);
            }
            stack.push(j);
            res += ijCnt;
        }
    }
    return res;
}
```
ä¸ºäº†æ–¹ä¾¿å›é¡¾ï¼Œç®€å•çš„ç”»äº†ä¸ªå›¾
![mark](http://static.imlgw.top/blog/20200705/BDIQmVW7vEuT.png?imageslim)
> è¿™é¢˜å¥½åƒæ˜¯ä¸ªå¾ˆç»å…¸çš„é¢˜ï¼Œæˆ‘åœ¨ç½‘ä¸Šæœç´¢çš„çš„æ—¶å€™å‘ç°å’Œ[ICPCçš„ä¸€é“é¢˜](https://blog.csdn.net/qq_40774175/article/details/82354072)ä¸€æ ·

**è§£æ³•ä¸‰**

åœ¨åˆ·äº†å‡ éè¯„è®ºåŒºï¼Œçœ‹è§äº†å¤§ä½¬ä»¬å†™çš„æ¯”è¾ƒå¥½è§£æ³•ï¼Œå‘ç°äº†ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“ç†è§£çš„å•è°ƒæ ˆçš„æ€è·¯

ï¼ˆ1ï¼‰ç¬¬ä¸€æ­¥é¢„å¤„ç†å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‘ä¸Šå»¶ç”³çš„æœ€å¤§å€¼
ï¼ˆ2ï¼‰ç„¶åæˆ‘ä»¬åŒæ ·ä½¿ç”¨å•è°ƒé€’å¢æ ˆç»´æŠ¤è¿™ä¸ªé«˜åº¦ï¼Œä½†æ˜¯åŒæ—¶æˆ‘ä»¬é¢å¤–çš„ç»´æŠ¤å¦ä¸€ä¸ªå€¼ï¼š**ä»¥å½“å‰`mat[i][j]`ä¸ºå³ä¸‹è§’æ‰€å½¢æˆçš„çŸ©å½¢ä¸ªæ•°ä¹Ÿå­˜å…¥å•è°ƒæ ˆ** ï¼Œç„¶åæˆ‘ä»¬åœ¨æ¯ä¸ªå…ƒç´ è¿›æ ˆçš„æ—¶å€™ç»Ÿè®¡ä¸ªæ•°ï¼Œç»Ÿè®¡ä¸€å…±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

![mark](http://static.imlgw.top/blog/20200828/x8M127uqudmS.png?imageslim)
ï¼ˆ2020.8.28æ›´æ–°äº†ä¸€ä¸‹ï¼Œä¹‹å‰çš„å›¾æœ‰ç‚¹æŠ½è±¡ï¼‰

```java
public int numSubmat(int[][] mat) {
    int m = mat.length;
    int n = mat[0].length;
    //é¢„å¤„ç†mat[i][j]ä¸Šè¾¹æœ‰å¤šå°‘ä¸ªè¿ç»­çš„1
    int[][] upCnt= new int[m][n];
    for (int i = 0; i < m; i++) {
        for (int j = 0; j < n; j++) {
            if(mat[i][j] == 1){
                upCnt[i][j] = i==0 ? mat[i][j]&1 : upCnt[i-1][j]+1;
            }
        }
    }
    //å•è°ƒé€’å¢æ ˆç»´æŠ¤åˆ—çš„é•¿åº¦
    Deque<int[]> stack = new ArrayDeque<>();
    int res = 0;
    for(int i = 0;i < m; i++){
        stack.clear();
        for (int j = 0; j < n; j++) {
            while(!stack.isEmpty() && upCnt[i][stack.peek()[0]] > upCnt[i][j]){
                stack.pop();
            }
            int[] pair = stack.isEmpty() ? new int[]{-1,0} : stack.peek();
            //ä»¥å½“å‰æ ˆé¡¶å…ƒç´ mat[i][pair[0]]ä¸ºå³ä¸‹è§’èƒ½å½¢æˆçŸ©å½¢ä¸ªæ•°
            int cur = (j-pair[0]) * upCnt[i][j] + pair[1];
            res += cur;
            //å°†mat[i][j]çš„ç´¢å¼•jå’Œä»¥å…¶ä¸ºå³ä¸‹è§’å½¢æˆçš„çŸ©é˜µä¸ªæ•°curä¹Ÿå­˜å…¥å•è°ƒæ ˆ
            stack.push(new int[]{j, cur});
        }
    }
    return res;
}
```
è¿™ä¸ªæ€è·¯æ¯”ä¸Šé¢è¦å®¹æ˜“ç†è§£å¤šäº†

## [é¢è¯•é¢˜ 03.05. æ ˆæ’åº](https://leetcode-cn.com/problems/sort-of-stacks-lcci/)

Difficulty: **ä¸­ç­‰**

æ ˆæ’åºã€‚ ç¼–å†™ç¨‹åºï¼Œå¯¹æ ˆè¿›è¡Œæ’åºä½¿æœ€å°å…ƒç´ ä½äºæ ˆé¡¶ã€‚æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€ä¸ªå…¶ä»–çš„ä¸´æ—¶æ ˆå­˜æ”¾æ•°æ®ï¼Œä½†ä¸å¾—å°†å…ƒç´ å¤åˆ¶åˆ°åˆ«çš„æ•°æ®ç»“æ„ï¼ˆå¦‚æ•°ç»„ï¼‰ä¸­ã€‚è¯¥æ ˆæ”¯æŒå¦‚ä¸‹æ“ä½œï¼š`push`ã€`pop`ã€`peek` å’Œ `isEmpty`ã€‚å½“æ ˆä¸ºç©ºæ—¶ï¼Œ`peek`Â è¿”å› -1ã€‚

**ç¤ºä¾‹1:**

```go
 è¾“å…¥ï¼š
["SortedStack", "push", "push", "peek", "pop", "peek"]
[[], [1], [2], [], [], []]
 è¾“å‡ºï¼š
[null,null,null,1,null,2]
```

**ç¤ºä¾‹2:**

```go
 è¾“å…¥ï¼š 
["SortedStack", "pop", "pop", "push", "pop", "isEmpty"]
[[], [], [], [1], [], []]
 è¾“å‡ºï¼š
[null,null,null,null,null,true]
```

**è¯´æ˜:**

1.  æ ˆä¸­çš„å…ƒç´ æ•°ç›®åœ¨[0, 5000]èŒƒå›´å†…ã€‚


**è§£æ³•ä¸€**

ä¹‹å‰åœ¨ä¹¦ä¸Šçœ‹åˆ°è¿‡è¿™ä¸€é¢˜ï¼Œä½†æ˜¯æ—¶é—´ä¹…äº†å¿˜äº†å’‹åšäº†ï¼Œåªè®°å¾—æ˜¯å•è°ƒæ ˆï¼Œæ€è€ƒäº†ä¸‹è¿˜æ˜¯å†™å‡ºæ¥äº†

å•è°ƒæ ˆï¼Œä¸»æ ˆå•è°ƒé€’å‡ï¼ˆè‡ªé¡¶å‘ä¸‹ï¼‰ï¼Œå½“é‡åˆ°å¤§äºæ ˆé¡¶çš„å…ƒç´ å°±å¼¹æ ˆï¼Œå¹¶å°†å¼¹å‡ºçš„å…ƒç´ ç”¨è¾…åŠ©æ ˆæ¥æ”¶ï¼Œå®Œäº‹äº†å†å°†å…ƒç´ pushè¿›å»ï¼Œæœ€åå°†è¾…åŠ©æ ˆä¸­çš„å…ƒç´ å†å€’å›å»å°±okäº†ï¼Œæ—¶é—´å¤æ‚åº¦N^2
```java
class SortedStack {
 Â  Â 
 Â  Â Deque<Integer> stack = null;
 Â  Â 
 Â  Â Deque<Integer> help = null;
 Â  Â //å•è°ƒæ ˆæ’åº
 Â  Â //4 3 2 1 3 4 2
 Â  Â public SortedStack() {
 Â  Â  Â  Â stack = new ArrayDeque<>();
 Â  Â  Â  Â help = new ArrayDeque<>();
 Â   }
 Â  Â 
 Â  Â public void push(int val) {
 Â  Â  Â  Â //ä¸€å¼€å§‹å†™æˆpopäº†æ‰¾åŠå¤©çš„é”™
 Â  Â  Â  Â while(!stack.isEmpty() && stack.peek() < val) {
 Â  Â  Â  Â  Â  Â help.push(stack.pop());
 Â  Â  Â   }
 Â  Â  Â  Â stack.push(val);
 Â  Â  Â  Â //å†è£…å›å»
 Â  Â  Â  Â while(!help.isEmpty()) {
 Â  Â  Â  Â  Â  Â stack.push(help.pop());
 Â  Â  Â   }
 Â   }
 Â  Â 
 Â  Â public void pop() {
 Â  Â  Â  Â if (!stack.isEmpty()) {
 Â  Â  Â  Â  Â  Â stack.pop();
 Â  Â  Â   }
 Â   }
 Â  Â 
 Â  Â public int peek() {
 Â  Â  Â  Â if (stack.isEmpty()) {
 Â  Â  Â  Â  Â  Â return -1;
 Â  Â  Â   }
 Â  Â  Â  Â return stack.peek();
 Â   }
 Â  Â 
 Â  Â public boolean isEmpty() {
 Â  Â  Â  Â return stack.isEmpty();
 Â   }
}
```
## [NC580. æŠ¢æ‰“å‡ºå¤´é¸Ÿ](https://www.nowcoder.com/practice/1504075c856248748ca444c8c093d638)
ç°åœ¨æœ‰nä¸ªäººç«™æˆä¸€åˆ—ï¼Œç¬¬iä¸ªäººçš„èº«é«˜ä¸º`a[i]`ä»–ä»¬äººæ‰‹ä¸€æŠŠç©å…·æªï¼Œå¹¶ä¸”ä»–ä»¬å–œæ¬¢æŠŠæªä¸¾åœ¨å¤´é¡¶ä¸Šã€‚
æ¯ä¸€æ¬¡ç»ƒä¹ å°„å‡»ï¼Œä»–ä»¬éƒ½ä¼šæœæ­£å‰æ–¹å‘å°„ä¸€å‘æ°´å¼¹ã€‚
è¿™ä¸ªæ—¶å€™ï¼Œç¬¬iä¸ªäººå°„å‡»çš„æ°´å¼¹ï¼Œå°±ä¼šå‡»ä¸­åœ¨ä»–å‰é¢ç¬¬ä¸€ä¸ªæ¯”ä»–é«˜çš„äººã€‚
ç‰›ç‰›è®¤ä¸ºè¿™æ ·çš„ç»ƒä¹ ååˆ†çš„è’å”ï¼Œå®Œå…¨å°±æ˜¯å¯¹é•¿å¾—é«˜çš„äººçš„ä¼¤å®³ã€‚
äºæ˜¯å®ƒå®šä¹‰äº†ä¸€ä¸ªè’å”åº¦ï¼Œåˆå§‹ä¸º0ã€‚
å¯¹äºç¬¬iä¸ªäººï¼Œå¦‚ä¸­ä»–å‡»ä¸­äº†ç¬¬jä¸ªäººï¼Œåˆ™è’å”åº¦åŠ jï¼Œå¦‚æœæ²¡æœ‰å‡»ä¸­ä»»ä½•äººï¼Œåˆ™è’å”åº¦åŠ 0.
ç‰›ç‰›æƒ³é—®ä½ ï¼Œä½ èƒ½è®¡ç®—å‡ºè’å”åº¦æ˜¯å¤šå°‘å—ï¼Ÿ

**è¾“å…¥**

ä¸€ä¸ªæ•´æ•°nï¼ˆ1 â‰¤ n â‰¤ 10^7ï¼‰ï¼Œä¸€ä¸ªæ•°ç»„a (1 â‰¤ a[i] â‰¤ 10^7)
aä¸‹æ ‡ä»0å¼€å§‹ï¼Œ`a[i]` ä»£è¡¨ç¬¬iä¸ªäººèº«é«˜

**ç¤ºä¾‹1**
```go
è¾“å…¥: 5,[1,2,3,4,5]
è¾“å‡º: 0
è¯´æ˜: æ²¡æœ‰ä¸€ä¸ªäººå‡»ä¸­ä»»ä½•ä¸€ä¸ªäºº
```
**ç¤ºä¾‹2**
```go
è¾“å…¥: 5,[5,4,3,2,1]
è¾“å‡º: 10
è¯´æ˜: ç¬¬äºŒä¸ªäººå‡»ä¸­ç¬¬ä¸€ä¸ªäººï¼Œç¬¬ä¸‰ä¸ªäººå‡»ä¸­ç¬¬äºŒä¸ªäººï¼Œç¬¬å››ä¸ªäººå‡»ä¸­ç¬¬ä¸‰ä¸ªäººï¼Œç¬¬äº”ä¸ªäººå‡»ä¸­ç¬¬å››ä¸ªäººï¼› 1+2+3+4=10
```

**è§£æ³•ä¸€**

å¾ˆç›´ç™½çš„å•è°ƒæ ˆï¼Œä½†æ˜¯ä¸€å¼€å§‹è¢«é¢˜ç›®çš„caseè¯¯å¯¼äº†ä¸‹ï¼Œæäº†ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼Œè¿™é‡Œå¾ˆå¾ˆæ˜æ˜¾åº”è¯¥æ˜¯é€’å‡æ ˆï¼Œé€’å¢æ ˆä¼šæŠŠåŸæœ¬å¤§çš„å€¼ç»™popå‡ºå»
```java
//5 4 3 4 1
//ä¸€å¼€å§‹è¢«ä¾‹å­ç»™è¯¯å¯¼äº†ï¼Œæäº†ä¸€æ‰‹å•è°ƒé€’å¢æ ˆ....
public long solve (int n, int[] a) {
    Deque<Integer> stack = new ArrayDeque<>();
    long res = 0l;
    for (int i = 0; i < n; i++) {
        while (!stack.isEmpty() && a[stack.peek()] <= a[i]) {
            stack.pop();
        }
        if (!stack.isEmpty()) {
            res += stack.peek()+1;
        }
        stack.push(i);
    }
    return res;
}
```